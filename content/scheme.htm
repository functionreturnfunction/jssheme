<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>Scheme Interpreter</title>
<style type=text/css>
#txtInput {
  width: 100%
}
.bold {
  font-weight: bold
}
</style>
</head>

<body>
<h1>Scheme Interpreter</h1>
<textarea id=txtInput></textarea><br>
<input type=button id=btnGo value="Go!" onclick="interpret()">
<input type=button id=btnTest value="Display Test Results" onclick="displayResults()">
<input type=button id=btnBenchmark value="Run Benchmark" onclick="benchmark()"><br/><br/>
<pre id=result></pre>

<hr>
<address></address>
<!-- hhmts start --> Last modified: Wed Mar 12 07:40:32 EDT 2008 <!-- hhmts end -->
<script type=text/javascript language=javascript src="../src/scheme.js"></script>
<script type=text/javascript language=javascript src="../lib/qunitRhino.js"></script>
<script type=text/javascript language=javascript src="../test/schemeTest.js"></script>
<script type=text/javascript language=javascript>
var CODE = '(define power (lambda (x y) (if (= 1 y) x (* x (power x (- y 1))))))';

function $(id) { return document.getElementById(id); }

$('txtInput').value = CODE;

function interpret() {
  try {
    var result = Interpreter.parse($('txtInput').value);
    if( result == undefined ) {
      result = ';Unspecified return value'
    } else {
      result = ';Value: ' + result.toString();
    }
    $('result').innerHTML = result;
  } catch(e) {
    if( !Interpreter.exception )
      throw(e);
    $('result').innerHTML = '<span class=bold>Exception:</span><br/>;' + e.toString();
  }
}

function displayResults() {
  var result = $('result');
  result.innerHTML = '';
  new QUnit.HtmlPrinter(result).print();
}

function benchmark() {
  var times = parseInt(prompt('How many times?', '100')) - 1;
  var code = $('txtInput').value;
  var result;
  var date = new Date();
  for( var i = 0; i < times; i++ ) {
    Interpreter.parse(code);
  }
  result = Interpreter.parse(code);
  date = new Date() - date;
  $('result').innerHTML = ';Value: ' + result.toString() + '<br>Took ' +
    date.toString() + 'ms to run ' + (++times).toString() + ' times.'
}
</script>
</body> </html>
